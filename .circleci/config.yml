version: 2.1

jobs:
  build:
    docker:
      - image: circleci/node:16

    steps:
      - checkout

      # Etapa para instalar as dependÃªncias e gerar o Storybooks
      # - run:
      #     name: Build Storybook
      #     command: |
      #       yarn
      #       yarn build-storybook

      # Etapa para implantar o Storybook no GitHub Pagess

      # Script para obter a lista de branches
      - run:
          name: Get branch list
          command: |
            BRANCHES=()
            while IFS= read -r branch; do
              BRANCHES+=("$branch")
            done < <(git ls-remote --heads origin | awk -F'/' '{print $3}')
            echo "${BRANCHES[@]}" > branch-list.txt
            cat branch-list.txt

      # - run:
      #     name: Deploy to GitHub Pages
      #     command: |
      #       git config --global user.email "luizleno15@gmail.com"
      #       git config --global user.name "luislenosilva15"
      #       git clone --branch=gh-pages git@github.com:luislenosilva15/github-static-page.git gh-pages
      #       mkdir -p gh-pages/repos/$CIRCLE_BRANCH
      #       cp -R storybook-static/* gh-pages/repos/$CIRCLE_BRANCH/

      # - run:
      #     name: Run Node.js script
      #     command: |
      #       cd gh-pages
      #       node list-folders.js
      #       git add .
      #       git commit -m "Deploy Storybook to GitHub Pages"
      #       git push origin gh-pages
